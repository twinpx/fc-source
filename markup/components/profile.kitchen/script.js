!function(a){"use strict";function b(){function b(b){b.stopPropagation();var c=a(this);return confirm(c.attr("title")+"?")?(a.ajax({url:c.closest(".b-kitchen__list").attr("data-delete-ajax-url"),type:"POST",data:"id="+c.closest(".b-kitchen__item").attr("data-id"),success:function(){c.closest(".b-kitchen__item").fadeOut(500,function(){a(this).remove()})},error:ajaxError}),!0):!1}function c(){function b(){var b=a.parseJSON(d.attr("data-balloon")),c=a.parseJSON(d.attr("data-ajax"));return b.id=d.attr("data-id"),b.model=d.find(".b-kitchen__item__model").text(),b.hidden=c,b.title={id:d.find(".b-kitchen__item__title").attr("data-id"),name:b.title},b.brand={id:d.find(".b-kitchen__item__brand").attr("data-id"),name:b.brand},b.model={id:d.find(".b-kitchen__item__model").attr("data-id"),name:b.model},b}function c(){document.getElementById("kitchen-equipment-add-form")&&a("#kitchen-equipment-add-form").popup({closeElem:".b-popup__close",close:function(){a(".b-kitchen__add-form").data("KitchenAddForm").reset().changeTitle("Добавить технику")}})}var d=a(this).closest(".b-kitchen__item"),e=b();c(),a(".b-kitchen__add-form").data("KitchenAddForm").fillForm(e).changeTitle("Редактировать технику","Сохранить")}a(".b-personal-page__kitchen").delegate(".b-delete-icon","click",b).delegate(".b-edit-icon","click",c)}function c(b){function c(){d(),e()}function d(){f.$elem=a(b),f.$elem.data("Badges",f),f.url=f.$elem.attr("data-url"),f.author=a(".b-personal-card__name__first").text()}function e(){function b(){var b=a(this).parent();if(b.find(".b-balloon").is("div"))b.find(".b-balloon").show();else{var c=a.parseJSON(b.attr("data-balloon"));c.text=c.text.replace(/\"/g,"");var d="http://"+window.location.hostname+b.find("img").attr("src"),e=f.author+" &mdash; "+c.title+" на Foodclub.ru",g=f.url,h="";""!=c.price&&(h='<div class="b-balloon__column-right b-balloon__price"><div class="b-balloon__small-heading">Ориентировочная цена</div><div class="b-balloon__price__value">'+c.price+" руб.</div></div>"),b.prepend('<div class="i-relative"><div class="b-kitchen__balloon b-balloon"><div class="b-balloon__pointer"></div><div class="b-balloon__heading">'+c.title+" "+c.brand+'</div><div class="b-balloon__text">'+c.text+'</div><div class="b-balloon__column-left b-balloon__rating"><div class="b-balloon__small-heading">Рейтинг Foodclub.ru</div><div class="b-balloon__rating__stars i-stars'+c.rating+'"></div></div>'+h+'<div class="i-clearfix"></div><div class="b-balloon__share"><span class="b-balloon__share__heading">Расскажите друзьям:</span> <a title="Через Вконтакте" class="b-balloon__share__item i-vkontakte" target="_blank" onclick="window.open(this.href, \'\', \'width=540,height=450\');return false;" href="http://vkontakte.ru/share.php?url='+g+"&amp;title="+e+"&amp;image="+d+"&amp;description="+c.text+'&amp;noparse=yes"></a><a title="Через Facebook" class="b-balloon__share__item i-facebook" target="_blank" onclick="window.open(this.href, \'\', \'width=540,height=450\');return false;" href="http://www.facebook.com/sharer.php?s=100&amp;p[title]='+e+"&amp;p[summary]="+c.text+"&amp;p[url]="+g+"&amp;p[images][0]="+d+'"></a><a title="Через Twitter" class="b-balloon__share__item i-twitter" target="_blank" onclick="window.open(this.href, \'\', \'width=540,height=450\');return false;" href="http://twitter.com/share?text='+e+"&amp;url="+g+'"></a><a title="Через Google" class="b-balloon__share__item i-google" target="_blank" onclick="window.open(this.href, \'\', \'width=540,height=450\');return false;" href="https://plus.google.com/share?url='+g+'"></a></div></div></div>')}}function c(){a(this).parent().find(".b-balloon").hide()}f.$elem.delegate(".b-kitchen__item__link, .b-balloon","mouseenter",b).delegate(".b-kitchen__item__link, .b-balloon","mouseleave",c)}var f=this;c()}a(function(){a(".b-kitchen__list").each(function(){new c(this)}),b()})}(jQuery);