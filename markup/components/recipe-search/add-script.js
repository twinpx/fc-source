function topSsNavUp(a){function b(a){return a.hasClass("heading")?!0:!1}function c(a){return a.hasClass("search_all")?!0:!1}function d(){topSsNavUp(a)}function e(a){a.addClass("hover")}var f=$(a),g=$("#top_search_list li.hover");if(""==g.text()){inputValue=f.val();var h=$("#top_search_list li:last");if(b(h))return d(),!1;e(h),f.val(c(h)?inputValue:h.text())}else{g.removeClass("hover");var h=g.prev("li");h.hasClass("heading")&&(h=h.prev("li")),""!=h.text()?(e(h),f.val(c(h)?inputValue:h.text())):f.val(inputValue)}}function topSsNavDown(a){var b=$("#top_search_list").children("ul").children("li.hover");if(""==$(b).text()){inputValue=$(a).attr("value");var c=$("#top_search_list").children("ul").children("li:first");$(c).attr("class")&&-1!=$(c).attr("class").search("heading")&&(c=$(c).next("li")),$(c).addClass("hover"),$(a).attr(-1!=$(c).attr("class").search("search_all")?{value:inputValue}:{value:$(c).text()})}else{$(b).removeClass("hover");var c=$(b).next("li");$(c).attr("class")&&-1!=$(c).attr("class").search("heading")&&(c=$(c).next("li")),""!=$(c).text()?($(c).addClass("hover"),$(a).attr(-1!=$(c).attr("class").search("search_all")?{value:inputValue}:{value:$(c).text()})):$(a).attr({value:inputValue})}}function topSsFunction(a){function b(a){/^[\u0400-\u04ff\s]*$/.test(a.val())||(a.val(a.val().substring(0,a.val().length-1)),b(a))}if(b($(a)),$("#top_search_list").children("ul").empty(),""!=$(a).attr("value")){var c=new String($(a).attr("value")).toLowerCase().replace("ё","е").replace("й","и").split(" "),d=buildSsList(a,c,ingredientSearchArray),e=buildSsList(a,c,recipeArray),f=buildSsList(a,c,cuisineArray),g=buildSsList(a,c,dishTypeArray),h=0;0!=d.length&&(h=addSsListItem(d,c,h,"Ингредиенты")),0!=e.length&&(h=addSsListItem(e,c,h,"Рецепты")),0!=f.length&&(h=addSsListItem(f,c,h,"Кухни")),0!=g.length&&(h=addSsListItem(g,c,h,"Типы блюд")),$("#top_search_list").children("ul").append('<li class="search_all"><a href="/search/'+$(a).attr("value")+'/">Все рецепты с «<span>'+$(a).attr("value")+"</span>»</a></li>"),$("#top_search_list").children("ul").append('<li class="search_all"><a href="/posts_search/?q='+$(a).attr("value")+'">Все записи с «<span>'+$(a).attr("value")+"</span>»</a></li>"),$("#top_search_list").children("ul").children("li").click(function(){$(a).attr({value:""}).focus(),$(this).parent().css({display:"none"}).empty();for(var b,c=0;c<searchArray[1].length;c++)$(this).text()==searchArray[1][c]&&(b=searchArray[0][c])}),$("#top_search_list").children("ul").css({display:"block"})}else $("#top_search_list").children("ul").css({display:"none"})}function addSsListItem(a,b,c,d){switch($("#top_search_list").children("ul").append(a.length>itemNum?'<li class="heading">'+d+" <div><div>"+itemNum+" из "+a.length+"</div></div></li>":'<li class="heading">'+d+"</li>"),0!=a.length&&(c=1),d){case"Ингредиенты":var e=ingredientSearchArray;break;case"Рецепты":var e=recipeArray;break;case"Кухни":var e=cuisineArray;break;case"Типы блюд":var e=dishTypeArray}for(var f,g,h,i="",j=0;itemNum>j;j++){for(var k=0;k<e[0].length;k++)e[1][k].toLowerCase()==a[j].toLowerCase()&&(i=e[0][k]);switch(d){case"Ингредиенты":var l="/search_service/?id="+i;break;case"Рецепты":var l="/detail/"+i+"/";break;case"Кухни":var l="/all/?k="+i;break;case"Типы блюд":var l="/all/?d="+i}h=a[j].toLowerCase().replace("ё","е").replace("й","и");for(var m=0;m<b.length;m++){f=b[m].length,g=h.indexOf(b[m]),arrayIstr="";for(var n=0;n<b[m].length;n++)arrayIstr+=" ";h=h.split(b[m])[0]+"<span>"+arrayIstr+"</span>"+h.split(b[m])[1],a[j]=a[j].slice(0,g)+"<span>"+a[j].slice(g,g+f)+"</span>"+a[j].slice(g+f)}$("#top_search_list").children("ul").append('<li><a href="../recipe-search-new/'+l+'">'+a[j]+"</a></li>")}return c}function buildSsList(a,b,c){for(var d=new Array,e=0;e<c[1].length;e++)d.push(String(c[1][e]).toLowerCase().replace("ё","е").replace("й","и"));for(var f,g=new Array,e=0;e<d.length;e++){f=100;for(var h=0;h<b.length;h++)f=Math.min(f,d[e].indexOf(b[h])),d[e]=d[e].split(b[h])[0]+d[e].split(b[h])[1];-1!=f&&(g[f]||(g[f]=new Array),g[f].push(c[1][e]))}for(var i=new Array,e=0;e<g.length;e++)if(g[e]){g[e].sort();for(var j=0;j<g[e].length;j++)i.push(g[e][j])}return i}function topSsPressEnter(){var a=$("#top_search_list").find("li.hover");window.location=$(a).text()?$(a).children("a").attr("href"):"/search/"+$("#recipe_search_field").attr("value")+"/"}var smartsearchIdArray=new Array,smartsearchUnitArray=new Array,smartsearchArray=new Array;$(function(){if(window.ingredientArray){for(var a=0;a<ingredientArray[0].length;a++)smartsearchIdArray=smartsearchIdArray.concat(ingredientArray[2][a][0]),smartsearchUnitArray=smartsearchUnitArray.concat(ingredientArray[2][a][2]),smartsearchArray=smartsearchArray.concat(ingredientArray[2][a][1]);ingredientSearchArray=new Array(smartsearchIdArray,smartsearchArray)}});var inputValue,itemNum=5;